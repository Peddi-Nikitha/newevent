(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[544],{6509:function(e,s,a){Promise.resolve().then(a.bind(a,3128))},3128:function(e,s,a){"use strict";a.r(s),a.d(s,{default:function(){return i}});var r=a(7437),l=a(2265),t=a(605),n=a(9376),d=a(6945),o=a(7648);function i(){var e,s,a,i;let{data:c,status:m,update:u}=(0,t.useSession)(),h=(0,n.useRouter)(),[x,p]=(0,l.useState)(!0),[f,b]=(0,l.useState)(!1),[w,N]=(0,l.useState)({type:"",text:""}),[j,y]=(0,l.useState)({fullName:"",email:"",phone:"",currentPassword:"",newPassword:"",confirmPassword:""});(0,l.useEffect)(()=>{"unauthenticated"===m?h.push("/login"):"authenticated"===m&&(null==c?void 0:c.user)&&(y({...j,fullName:c.user.name||"",email:c.user.email||"",phone:""}),p(!1))},[m,c,h]);let v=e=>{let{name:s,value:a}=e.target;y(e=>({...e,[s]:a}))},g=async e=>{e.preventDefault();try{b(!0),N({type:"",text:""});let e=await fetch("/api/user/profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({fullName:j.fullName,phone:j.phone})}),s=await e.json();if(!e.ok)throw Error(s.message||"Failed to update profile");await u({...c,user:{...null==c?void 0:c.user,name:j.fullName}}),N({type:"success",text:"Profile updated successfully!"})}catch(e){N({type:"error",text:e.message})}finally{b(!1)}},P=async e=>{if(e.preventDefault(),j.newPassword!==j.confirmPassword){N({type:"error",text:"New passwords do not match"});return}if(j.newPassword.length<8){N({type:"error",text:"Password must be at least 8 characters"});return}try{b(!0),N({type:"",text:""});let e=await fetch("/api/user/password",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:j.currentPassword,newPassword:j.newPassword})}),s=await e.json();if(!e.ok)throw Error(s.message||"Failed to update password");y({...j,currentPassword:"",newPassword:"",confirmPassword:""}),N({type:"success",text:"Password updated successfully!"})}catch(e){N({type:"error",text:e.message})}finally{b(!1)}};return x?(0,r.jsx)(d.Z,{children:(0,r.jsx)("div",{className:"container mx-auto py-16 px-4",children:(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary"})})})}):(0,r.jsx)(d.Z,{children:(0,r.jsx)("div",{className:"container mx-auto py-16 px-4",children:(0,r.jsxs)("div",{className:"flex flex-wrap -mx-4",children:[(0,r.jsx)("div",{className:"w-full md:w-1/4 px-4 mb-8",children:(0,r.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-6",children:[(0,r.jsxs)("div",{className:"text-center mb-6",children:[(0,r.jsx)("div",{className:"w-24 h-24 rounded-full bg-gray-200 mx-auto mb-4 flex items-center justify-center",children:(0,r.jsx)("span",{className:"text-3xl text-gray-500",children:(null==c?void 0:null===(s=c.user)||void 0===s?void 0:null===(e=s.name)||void 0===e?void 0:e.charAt(0).toUpperCase())||"U"})}),(0,r.jsx)("h2",{className:"text-xl font-semibold",children:(null==c?void 0:null===(a=c.user)||void 0===a?void 0:a.name)||"User"}),(0,r.jsx)("p",{className:"text-gray-600",children:null==c?void 0:null===(i=c.user)||void 0===i?void 0:i.email})]}),(0,r.jsx)("nav",{className:"dashboard-nav",children:(0,r.jsxs)("ul",{children:[(0,r.jsx)("li",{className:"mb-1",children:(0,r.jsx)(o.default,{href:"/dashboard",className:"block py-2 px-4 rounded hover:bg-gray-100",children:"Dashboard"})}),(0,r.jsx)("li",{className:"mb-1",children:(0,r.jsx)(o.default,{href:"/dashboard/events",className:"block py-2 px-4 rounded hover:bg-gray-100",children:"My Events"})}),(0,r.jsx)("li",{className:"mb-1",children:(0,r.jsx)(o.default,{href:"/dashboard/bookings",className:"block py-2 px-4 rounded hover:bg-gray-100",children:"My Bookings"})}),(0,r.jsx)("li",{className:"mb-1",children:(0,r.jsx)(o.default,{href:"/dashboard/profile",className:"block py-2 px-4 rounded bg-primary text-white",children:"Profile Settings"})})]})})]})}),(0,r.jsx)("div",{className:"w-full md:w-3/4 px-4",children:(0,r.jsxs)("div",{className:"bg-white shadow-md rounded-lg p-8",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Profile Settings"}),w.text&&(0,r.jsx)("div",{className:"p-4 mb-6 rounded ".concat("success"===w.type?"bg-green-100 text-green-700 border border-green-400":"bg-red-100 text-red-700 border border-red-400"),children:w.text}),(0,r.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Personal Information"}),(0,r.jsxs)("form",{onSubmit:g,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"fullName",className:"form-label",children:"Full Name"}),(0,r.jsx)("input",{type:"text",id:"fullName",name:"fullName",value:j.fullName,onChange:v,className:"form-input",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"email",className:"form-label",children:"Email Address"}),(0,r.jsx)("input",{type:"email",id:"email",name:"email",value:j.email,className:"form-input bg-gray-100",disabled:!0}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"Email cannot be changed"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{htmlFor:"phone",className:"form-label",children:"Phone Number"}),(0,r.jsx)("input",{type:"tel",id:"phone",name:"phone",value:j.phone,onChange:v,className:"form-input",placeholder:"(123) 456-7890"})]}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary ".concat(f?"opacity-70 cursor-not-allowed":""),disabled:f,children:f?"Saving...":"Save Changes"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Change Password"}),(0,r.jsxs)("form",{onSubmit:P,children:[(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"currentPassword",className:"form-label",children:"Current Password"}),(0,r.jsx)("input",{type:"password",id:"currentPassword",name:"currentPassword",value:j.currentPassword,onChange:v,className:"form-input",required:!0})]}),(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("label",{htmlFor:"newPassword",className:"form-label",children:"New Password"}),(0,r.jsx)("input",{type:"password",id:"newPassword",name:"newPassword",value:j.newPassword,onChange:v,className:"form-input",required:!0,minLength:8}),(0,r.jsx)("p",{className:"text-sm text-gray-500 mt-1",children:"At least 8 characters"})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("label",{htmlFor:"confirmPassword",className:"form-label",children:"Confirm New Password"}),(0,r.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:j.confirmPassword,onChange:v,className:"form-input",required:!0})]}),(0,r.jsx)("button",{type:"submit",className:"btn btn-primary ".concat(f?"opacity-70 cursor-not-allowed":""),disabled:f,children:f?"Updating...":"Update Password"})]})]})]})]})})]})})})}},9376:function(e,s,a){"use strict";var r=a(5475);a.o(r,"notFound")&&a.d(s,{notFound:function(){return r.notFound}}),a.o(r,"useRouter")&&a.d(s,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(s,{useSearchParams:function(){return r.useSearchParams}})}},function(e){e.O(0,[605,648,945,971,117,744],function(){return e(e.s=6509)}),_N_E=e.O()}]);